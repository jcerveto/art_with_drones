<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="module" src="script2.js"></script>
    <title>AwD</title>
</head>

<body>
    <header>
        <h1>Art With Drones</h1>
    </header>
    <nav>
        <button onclick="generateRandomMap()">Generar Mapa Random</button>
        <button onclick="generateEmptyMap()">Vaciar Mapa</button>
        <button onclick="connectToKafka()">Conectar a AD_Engine</button>
    </nav>

    <main>
        <div class="map-container" id="map-container"></div>
        <article class="description">
            <p>Este es un mapa generado aleatoriamente con celdas rojas, verdes o sin fondo.</p>
        </article>
    </main>

    <footer>
        Joan Cerveto Serrano
    </footer>
    <ul id="messages"></ul>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        
        socket.on('map', (mapData) => {
            const mapContainer = document.getElementById('map-container');
            mapContainer.innerHTML = ''; // Limpiar el contenedor antes de agregar nuevas celdas
            console.log(mapData.map);
            mapArray = Array.from(mapData.map);
            console.log(mapArray.length);
            for (let i = 0; i < mapArray.length; i++) {
                if (mapArray[i].status == 'bad') {
                    console.log("red")
                } else if (mapArray[i].status == 'good') {
                    console.log("green")
                } else {
                    console.log('?')
                }
            }

            mapArray.forEach((cell) => {
                const newCell = document.createElement('div');
                newCell.className = 'cell';
                newCell.textContent = cell.status;
                mapContainer.appendChild(newCell);
            });
            console.log("Map rendered")
        });
    </script>
</body>

</html>
